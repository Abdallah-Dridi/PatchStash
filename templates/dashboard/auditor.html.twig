{% extends 'admin/base.html.twig' %}

{% block title %}Auditor Dashboard ¬∑ Patchstash{% endblock %}

{% block admin_content %}
<div class="page-head">
    <div>
        <p class="eyebrow">Dashboard</p>
        <h1>Auditor</h1>
        <p class="text-muted">Review compliance, reports, and security posture.</p>
    </div>
</div>

<div class="admin-section" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.2rem; margin-bottom: 2rem;">
    <div class="stat-card">
        <div class="stat-meta">
            <p class="stat-label">Auditable Projects</p>
            <p class="stat-value">{{ totalProjects }}</p>
        </div>
        <div class="stat-icon">üìë</div>
    </div>
    <div class="stat-card">
        <div class="stat-meta">
            <p class="stat-label">Role</p>
            <p class="stat-value" style="font-size: 1.5rem; color: var(--accent);">Auditor</p>
        </div>
        <div class="stat-pill" style="border-color: var(--accent); color: var(--accent);">Compliance</div>
    </div>
</div>

<div class="admin-panel">
    <div class="panel-header">
        <div>
            <h2>Projects Under Audit</h2>
            <p class="text-muted">Monitoring security status and patch compliance.</p>
        </div>
        {% if projects|length > 0 %}
             <a class="btn primary" href="{{ path('app_project_index') }}">View all</a>
        {% endif %}
    </div>
    
    {% if projects|length > 0 %}
    <div class="admin-table">
        <table>
            <thead>
                <tr>
                    <th>Project</th>
                    <th>Status</th>
                    <th>Modules</th>
                    <th class="text-end">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for project in projects|slice(0, 5) %}
                <tr>
                    <td><strong>{{ project.name }}</strong></td>
                    <td><span class="badge neutral">Under Audit</span></td>
                    <td><span class="badge low">{{ project.modules|length }} Modules</span></td>
                    <td class="text-end">
                        <a class="btn ghost small" href="{{ path('app_project_show', {'id': project.id}) }}">View</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state" style="padding: 3rem; text-align: center;">
        <p class="text-muted">No projects currently assigned for audit.</p>
    </div>
    {% endif %}
</div>

<div class="admin-section" style="margin-top: 2rem;">
    <div class="admin-panel">
        <div class="panel-header">
            <h2>Audit Tools</h2>
        </div>
        <div class="quick-actions">
            <a href="{{ path('app_report_index') }}" class="action-card" style="text-decoration: none;">
                <h3 style="margin:0; color:#f8fafc; font-size:1rem;">üìä Reports</h3>
                <p class="text-muted" style="font-size:0.85rem; margin:0;">Generate audit-ready documentation</p>
                <span class="badge active" style="width: fit-content; margin-top:0.5rem;">Primary</span>
            </a>
            <a href="{{ path('app_vulnerability_index') }}" class="action-card" style="text-decoration: none;">
                <h3 style="margin:0; color:#f8fafc; font-size:1rem;">‚ö†Ô∏è Vulnerabilities</h3>
                <p class="text-muted" style="font-size:0.85rem; margin:0;">Review findings and remediation</p>
            </a>
            <a href="{{ path('app_patch_cycle_index') }}" class="action-card" style="text-decoration: none;">
                <h3 style="margin:0; color:#f8fafc; font-size:1rem;">‚öôÔ∏è Patch Cycles</h3>
                <p class="text-muted" style="font-size:0.85rem; margin:0;">Verify deployment timelines</p>
            </a>
        </div>
    </div>
    
    <div class="admin-panel">
        <div class="panel-header">
            <h2>Compliance Standards</h2>
        </div>
        <div class="timeline">
            <ul>
                <li>
                    <div class="dot"></div>
                    <div>
                        <strong style="color: #f8fafc;">Regulatory Requirements</strong>
                        <p class="text-muted" style="margin:0.2rem 0 0;">Ensure alignment with industry security standards.</p>
                    </div>
                </li>
                <li>
                    <div class="dot"></div>
                    <div>
                        <strong style="color: #f8fafc;">Policy Enforcement</strong>
                        <p class="text-muted" style="margin:0.2rem 0 0;">Verify adherence to internal patching policies.</p>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}
